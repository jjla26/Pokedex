document.querySelector(".content__option").lastElementChild.addEventListener("click",()=>{const e=document.querySelector(".content"),t=document.querySelector(".pokemon__list"),n=e.querySelector(".content__option").querySelectorAll("button");staticPokemonRepository.getAll().forEach(e=>staticPokemonRepository.print(e)),staticPokemonRepository.renderStaticCount(),t.classList.remove("hidden"),document.querySelector("#addPokemon").classList.remove("hidden"),document.querySelector(".header__filter").classList.remove("hidden"),e.querySelector("h2").innerText="Your Pokemons",n.forEach(e=>e.classList.add("hidden"))}),document.querySelector(".content__option").firstElementChild.addEventListener("click",()=>{const e=document.querySelector(".pokemon__dynamic-list"),t=document.querySelector(".content"),n=t.querySelector(".content__option").querySelectorAll("button");dynamicPokemonRepository.loadList().then(()=>{const e=dynamicPokemonRepository.getPokemonList();dynamicPokemonRepository.printList(e),dynamicPokemonRepository.renderDynamicCount()}),t.querySelector("h2").innerText="Your Pokemons",e.classList.remove("hidden"),n.forEach(e=>e.classList.add("hidden"))});const customModal=function(){return{showModal:function(e,t){const n=document.querySelector(".modal-body"),o=document.querySelector(".modal-title");o.innerHTML="",n.innerHTML="",o.innerHTML=e,n.appendChild(t)},hideModal:function(){let e=document.getElementById("modal");(e=bootstrap.Modal.getInstance(e)).hide()}}}(),staticPokemonRepository=function(){let e=[{id:Math.random().toString(36),name:"Bulbasaur",img:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/1.png",height:.7,weight:6.9,abilities:["chlorophyll","overgrow"],types:["grass","poison"]},{id:Math.random().toString(36),name:"Pidgey",img:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/16.png",height:.3,weight:1.8,abilities:["keen-eye","tangled-feet","big-pecks"],types:["flying","normal"]},{id:Math.random().toString(36),name:"Pikachu",img:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/25.png",height:.4,weight:6,abilities:["static","lightningrod"],types:["electric"]},{id:Math.random().toString(36),name:"Ponyta",img:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/77.png",height:1,weight:30,abilities:["flash-fire","flame-body","run-away"],types:["fire"]},{id:Math.random().toString(36),name:"Squirtle",img:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/7.png",height:.5,weight:9,abilities:["rain-dish","torrent"],types:["water"]},{id:Math.random().toString(36),name:"Charmander",img:"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/4.png",height:.6,weight:8.5,abilities:["blaze","solar-power"],types:["fire"]}];function t(){return e}function n(){const e=document.querySelector(".content").querySelector("span");e.classList.remove("hidden"),e.innerText=`(Total Pokemon: ${t().length})`}function o(t){const o=e.filter(e=>e.id!==t);return e=o,n(),e}function i(e){const t=document.querySelector(".pokemon__list"),n=document.createElement("div");n.classList.add("card",...e.types);const i=document.createElement("div");i.classList.add("card__action"),n.appendChild(i);const r=document.createElement("button");r.classList.add("delete-btn","action__button"),r.setAttribute("id",e.id),r.innerText="-";const d=document.createElement("button");d.classList.add("edit-btn","action__button"),d.innerText="edit",d.setAttribute("data-bs-toggle","modal"),d.setAttribute("data-bs-target","#modal"),i.appendChild(r),i.appendChild(d);const c=document.createElement("div");c.classList.add("card__image-container"),n.appendChild(c);const a=document.createElement("img");a.classList.add("card__image"),a.src=e.img,a.crossOrigin="anonymous",c.appendChild(a);const s=document.createElement("h3");s.innerText=e.name,n.appendChild(s);const l=document.createElement("div");l.classList.add("card__description"),n.appendChild(l);const m=document.createElement("p");m.innerText=`Type: ${e.types}`,l.appendChild(m);const u=document.createElement("p");u.innerText=`Height: ${e.height}`,l.appendChild(u);const p=document.createElement("p");p.innerText=`Weight: ${e.weight}`,l.appendChild(p);const h=document.createElement("p");h.innerText=`Abilities: ${e.abilities}`,l.appendChild(h),t.appendChild(n);const g=new ColorThief;a.addEventListener("load",function(){const e=g.getColor(a);n.style.backgroundImage=`linear-gradient(0deg, rgb(${e}), rgba(255, 255, 255))`,n.style.border=`10px solid rgb(${e})`}),r.addEventListener("click",e=>{o(e.target.id);const t=e.target.parentNode.parentNode;t.parentNode.removeChild(t)}),function(e,t){e.addEventListener("click",()=>{const e=document.querySelector(".form__pokemon");e.classList.remove("hidden"),document.getElementById("id").value=t.id,document.getElementById("name").value=t.name,document.getElementById("img").value=t.img,document.getElementById("height").value=t.height,document.getElementById("weight").value=t.weight,document.getElementById("type").value=t.types.join(),document.getElementById("abilities").value=t.abilities.join(),e.querySelector("button").innerText="Edit Pokemon",customModal.showModal("Edit Pokemon",e)})}(d,e)}function r(t,n){const o=a(n);if(o)return alert(o),!1;{const o={id:t,...n},i=e.find(e=>e.id===t),r=e.map(e=>e.id===t?o:e);return e=r,{newPokemon:o,oldPokemon:i}}}function d(t){const o=a(t);if(o)return alert(o),!1;{const o={id:Math.random().toString(36),...t},i=e.concat(o);return e=i,n(),o}}function c(e){document.querySelectorAll(".card").forEach(t=>{t.querySelector("h3").innerText.toLowerCase().indexOf(e.toLowerCase())>-1?t.classList.remove("hidden"):t.classList.add("hidden")})}function a(e){return"object"==typeof e?"string"!=typeof e.name?"Your pokemon should have a name":"number"!=typeof e.height?"Your pokemon should have a height and it should be a number":"number"!=typeof e.weight?"Your pokemon should have a weight and it should be a number":"object"!=typeof e.abilities?"Your pokemon should have abilities (you should separate them by comma)":e.types.find(e=>"fire"===e||"flying"===e||"grass"===e||"electric"===e||"water"===e||"other"===e)?null:"Your pokemon types should have one of theses (fire, flying, grass, electric, water, other)":"Ups, this is not a pokemon"}function s(){const e=document.querySelector(".form__pokemon");document.querySelectorAll("input").forEach(e=>e.value=""),e.classList.remove("hidden"),e.querySelector("button").innerText="Add a new Pokemon",customModal.showModal("Add a new Pokemon",e)}return document.querySelector("#addPokemon").addEventListener("click",()=>{s()}),document.querySelector(".header__filter").addEventListener("input",e=>{c(e.target.value)}),document.querySelector(".form__pokemon").onsubmit=(e=>{e.preventDefault();const t=document.querySelector(".pokemon__list"),n=document.getElementById("id").value,o=document.getElementById("name").value,c=document.getElementById("img").value,a=parseFloat(document.getElementById("height").value),s=parseFloat(document.getElementById("weight").value),l=document.getElementById("type").value.split(","),m=document.getElementById("abilities").value.split(",");if("Add a new Pokemon"===document.querySelector(".form__pokemon").querySelector("button").innerHTML){const e=d({name:o,img:c,height:a,weight:s,types:l,abilities:m});e&&(i(e),customModal.hideModal())}else{const e=r(n,{name:o,img:c,height:a,weight:s,types:l,abilities:m});if(e){const n=e.oldPokemon;i(e.newPokemon);const o=t.lastElementChild;document.querySelectorAll(".card").forEach(e=>{e.querySelector("h3").innerText===n.name&&t.replaceChild(o,e)}),customModal.hideModal()}}}),{getAll:t,add:d,edit:r,remove:o,print:i,restoreList:function(){document.querySelectorAll(".card").forEach(e=>e.classList.remove("hidden"))},filterByName:c,renderStaticCount:n,addButtonAction:s}}(),dynamicPokemonRepository=function(){let e,t=[],n=5,o=`https://pokeapi.co/api/v2/pokemon/?limit=${n}`,i="",r=0,d=0;function c(){return t.slice(d,d+n)}function a(t=o){const n=document.querySelector(".pokemon__dynamic-list");n.querySelector(".spinner").classList.remove("hidden");const r=document.querySelector(".content__next-button"),d=document.querySelector(".content__previous-button");return fetch(t).then(e=>e.json()).then(t=>{e=t.count,t.next?(r.disabled=!1,i=t.next):r.disabled=!0,t.previous?d.disabled=!1:d.disabled=!0,t.results.forEach(e=>{s({id:Math.random().toString(36),name:e.name,detailsUrl:e.url}),n.querySelector(".spinner").classList.add("hidden"),document.querySelector(".content__pagination").classList.remove("hidden")})}).catch(e=>{console.log(e),n.querySelector(".spinner").classList.remove("hidden")})}function s(e){if(!function(e){return"object"==typeof e?"string"!=typeof e.name?"Your pokemon should have a name":null:"Ups, this is not a pokemon"}(e)){const n=t.concat(e);t=n}}function l(e,t){const n=t.parentNode,o=document.createElement("div");o.classList.add("card",...e.types),o.setAttribute("data-bs-toggle","modal"),o.setAttribute("data-bs-target","#modal");const i=document.createElement("div");i.classList.add("card__image-container"),o.appendChild(i);const r=document.createElement("img");r.classList.add("card__image"),r.src=e.img,r.crossOrigin="anonymous",i.appendChild(r);const d=document.createElement("h3");d.innerText=e.name,o.appendChild(d);const c=document.createElement("div");c.classList.add("card__description"),o.appendChild(c);const a=document.createElement("p");a.innerText=`Type: ${e.types}`,c.appendChild(a);const s=document.createElement("p");s.innerText=`Height: ${e.height}`,c.appendChild(s);const l=document.createElement("p");l.innerText=`Weight: ${e.weight}`,c.appendChild(l);const m=document.createElement("p");m.innerText=`Abilities: ${e.abilities}`,c.appendChild(m),function(e,t){e.addEventListener("click",()=>{const e=document.createElement("div");e.classList.add("details__container");const n=document.createElement("div");n.classList.add("details__image");const o=document.createElement("div");o.classList.add("details__content");const i=document.createElement("img");i.classList.add("card__image"),i.src=t.img;const r=document.createElement("p");r.innerText=`Type: ${t.types}`;const d=document.createElement("p");d.innerText=`Height: ${t.height}`;const c=document.createElement("p");c.innerText=`Weight: ${t.weight}`;const a=document.createElement("p");a.innerText=`Abilities: ${t.abilities}`;const s=document.createElement("p");s.innerText=`Moves: ${t.moves.map(e=>` ${e}`)}`,o.appendChild(r),o.appendChild(d),o.appendChild(c),o.appendChild(a),o.appendChild(s),n.appendChild(i),e.appendChild(n),e.appendChild(o),customModal.showModal("Pokemon Detail",e)})}(o,e);const u=new ColorThief;r.addEventListener("load",function(){const e=u.getColor(r);o.style.backgroundImage=`linear-gradient(0deg, rgb(${e}), rgba(255, 255, 255))`,o.style.border=`10px solid rgb(${e})`}),n.insertBefore(o,t.nextSibling)}function m(e){const t=document.querySelector(".pokemon__dynamic-list"),n=document.createElement("ul");n.classList.add("list-group","d-flex","justify-content-between","align-items-center"),e.forEach(e=>{const o=document.createElement("li");o.classList.add("pokemon__item","list-group-item");const i=document.createElement("h4");i.innerText=e.name,o.appendChild(i),n.appendChild(o),t.appendChild(n),function(e,t){e.addEventListener("click",()=>{!function(e,t){e.height?t.parentNode.querySelectorAll(".card").forEach(t=>{t.querySelector("h3").innerText===e.name?t.classList.toggle("hidden"):t.classList.add("hidden")}):function(e,t){const n=document.querySelector(".pokemon__dynamic-list"),o=n.querySelector(".spinner");return o.classList.remove("hidden"),t.parentNode.insertBefore(o,t.nextSibling),fetch(e.detailsUrl).then(e=>e.json()).then(e=>(o.classList.add("hidden"),n.appendChild(o),e)).catch(()=>{o.classList.add("hidden"),n.appendChild(o)})}(e,t).then(n=>{e.img=n.sprites.other["official-artwork"].front_default,e.height=n.height,e.weight=n.weight,e.types=n.types.map(e=>e.type.name),e.abilities=n.abilities.map(e=>e.ability.name),e.moves=n.moves.map(e=>e.move.name),l(e,t)})}(t,e)})}(o,e)})}return document.querySelector(".content__next-button").addEventListener("click",function(){r+=1,d+=n,document.querySelectorAll(".pokemon__item").forEach(e=>{e.classList.add("hidden")}),document.querySelectorAll(".card").forEach(e=>{e.classList.add("hidden")}),document.querySelector(".content__previous-button").disabled=!1;const o=document.querySelector(".content__next-button");0===t.slice(d,d+n).length?(o.disabled=!0,a(i).then(()=>{m(c())})):([...document.querySelectorAll(".pokemon__item")].slice(r*n,r*n+n).forEach(e=>e.classList.remove("hidden")),o.disabled=e<=d+n)}),document.querySelector(".content__previous-button").addEventListener("click",function(){r-=1,d-=n,document.querySelectorAll(".pokemon__item").forEach(e=>{e.classList.add("hidden")}),document.querySelectorAll(".card").forEach(e=>{e.classList.add("hidden")});const e=document.querySelector(".content__previous-button");document.querySelector(".content__next-button").disabled=!1,0===d&&(e.disabled=!0),[...document.querySelectorAll(".pokemon__item")].slice(r*n,r*n+n).forEach(e=>e.classList.remove("hidden"))}),{loadList:a,getPokemonList:c,addDynamicList:s,printList:m,printCard:l,renderDynamicCount:function(){const t=document.querySelector(".content").querySelector("span");t.classList.remove("hidden"),t.innerText=`(Total Pokemon: ${e})`}}}();